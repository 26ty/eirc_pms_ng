<div class="container">
    <!--標題-->
    <div class="row">
        <div class="col-md-12 text-center">
            <div class="left">
                <h1>
                    <mat-icon>add</mat-icon>
                    <span class="text-left">
                        專案產銷會議 - 新增
                    </span>
                </h1>
            </div>
        </div>
    </div>
    <!--查詢區域2 未命名-->
    <form #elementsForm="ngForm">
        <div class="form-group-edit pt-3 pb-0">
            <div class="row">
                <div class="col-3">
                    <mat-card class="card search-group left-card text-center">
                        <div class="row mt-3">
                            <div class="col" *ngIf="projectDatas">
                                <h3 class="mb-0 label-Required">必填欄位</h3>

                                <mat-form-field appearance="outline">
                                    <mat-label>來源單號</mat-label>
                                    <input matInput disabled type="text" value={{customer_code}} ngDefaultControl>
                                </mat-form-field>

                                <mat-form-field appearance="outline">
                                    <mat-label>＊專案代號</mat-label>
                                    <input matInput type="text" [(ngModel)]="projectDatas.body.code" name="code"
                                        ngDefaultControl>
                                </mat-form-field>

                                <mat-form-field appearance="outline">
                                    <mat-label>＊機台總成品號</mat-label>
                                    <input matInput type="text" [(ngModel)]="projectDatas.body.machine_finished_number"
                                        name="machine_finished_number" ngDefaultControl>
                                </mat-form-field>

                                <mat-form-field appearance="outline">
                                    <mat-label>＊客戶</mat-label>
                                    <mat-select [(ngModel)]="projectDatas.body.customer_id" name="customer_id"
                                        ngDefaultControl>
                                        <mat-option *ngFor="let user of userList" [value]="user.id">
                                            {{user.name}}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>

                                <mat-form-field appearance="outline">
                                    <mat-label>＊專案負責人</mat-label>
                                    <mat-select [(ngModel)]="projectDatas.body.projectman_id" name="projectman_id"
                                        ngDefaultControl>
                                        <mat-option *ngFor="let user of userList" [value]="user.id">
                                            {{user.name}}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>

                                <mat-form-field appearance="outline">
                                    <mat-label>＊業務負責人</mat-label>
                                    <mat-select [(ngModel)]="projectDatas.body.salesman_id" name="salesman_id"
                                        ngDefaultControl>
                                        <mat-option *ngFor="let user of userList" [value]="user.id">
                                            {{user.name}}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>

                                <mat-form-field appearance="outline">
                                    <mat-label>＊客服負責人</mat-label>
                                    <mat-select [(ngModel)]="projectDatas.body.serviceman_id" name="serviceman_id"
                                        ngDefaultControl>
                                        <mat-option *ngFor="let user of userList" [value]="user.id">
                                            {{user.name}}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>

                                <mat-form-field appearance="outline">
                                    <mat-label>＊專案起始日</mat-label>
                                    <input matInput [matDatepicker]="picker_done"
                                        [(ngModel)]="projectDatas.body.date_for_start" name="date_for_start"
                                        ngDefaultControl>
                                    <mat-datepicker-toggle matSuffix [for]="picker_done">
                                    </mat-datepicker-toggle>
                                    <mat-datepicker #picker_done></mat-datepicker>
                                    <mat-error>
                                        必填
                                    </mat-error>
                                </mat-form-field>

                                <mat-form-field appearance="outline">
                                    <mat-label>＊專案結束日</mat-label>
                                    <input matInput [matDatepicker]="picker"
                                        [(ngModel)]="projectDatas.body.date_for_end" name="date_for_end"
                                        ngDefaultControl>
                                    <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                                    <mat-datepicker #picker></mat-datepicker>
                                    <mat-error>
                                        必填
                                    </mat-error>
                                </mat-form-field>
                                <!-- <div class="test">
                                    起始日：{{projectDatas.body.date_for_start| date: 'yyyy-MM-dd HH:mm'}}
                                    結束日：{{projectDatas.body.date_for_end| date: 'yyyy-MM-dd HH:mm'}}
                                </div>  -->
                                <!-- <mat-form-field appearance="outline">
                                    <mat-label>專案起始日</mat-label>
                                    <input matInput [matDatepicker]="picker" [(ngModel)]="projectDatas.body.date_for_start" name="date_for_start" ngDefaultControl>
                                    <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                                    <mat-datepicker #picker></mat-datepicker>
                                </mat-form-field>
                                <mat-form-field appearance="outline">
                                    <mat-label>專案結束日</mat-label>
                                    <input matInput [matDatepicker]="picker" [(ngModel)]="projectDatas.body.date_for_end" name="date_for_end" ngDefaultControl>
                                    <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                                    <mat-datepicker #picker></mat-datepicker>
                                </mat-form-field> -->

                                <mat-form-field appearance="outline">
                                    <mat-label>治具數量</mat-label>
                                    <input matInput type="text" [(ngModel)]="projectDatas.body.jig_quantity"
                                        name="jig_quantity" ngDefaultControl>
                                </mat-form-field>
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col" *ngIf="projectDatas">
                                <h3 class="mb-0">選填欄位</h3>

                                <mat-form-field appearance="outline">
                                    <mat-label>機台英文名稱</mat-label>
                                    <input matInput type="text" [(ngModel)]="projectDatas.body.machine_english"
                                        name="machine_english" ngDefaultControl>
                                </mat-form-field>

                                <mat-form-field appearance="outline">
                                    <mat-label>機台數量</mat-label>
                                    <input matInput type="text" [(ngModel)]="projectDatas.body.machine_quantity"
                                        name="machine_quantity" ngDefaultControl>
                                </mat-form-field>

                                <mat-form-field appearance="outline">
                                    <mat-label>外部訂單</mat-label>
                                    <input matInput type="text" [(ngModel)]="projectDatas.body.external_order"
                                        name="external_order" ngDefaultControl>
                                </mat-form-field>

                                <mat-form-field appearance="outline">
                                    <mat-label>內部訂單</mat-label>
                                    <input matInput type="text" [(ngModel)]="projectDatas.body.internal_order"
                                        name="internal_order" ngDefaultControl>
                                </mat-form-field>

                                <mat-form-field appearance="outline">
                                    <mat-label>摘要說明</mat-label>
                                    <textarea matInput type="text" [(ngModel)]="projectDatas.body.summary_description"
                                        name="summary_description" ngDefaultControl>
                                    </textarea>
                                </mat-form-field>
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col text-left">
                                <button mat-button class="btn-link-none" (click)="addmeetingItem(p_id)"><u
                                        class='text-link'>會議</u></button>
                                <button mat-button class="btn-link" (click)="addappendixItem()"><u
                                        class='text-link'>附件</u></button>
                                <button mat-button class="btn-link" (click)="addscheduleItem()"><u
                                        class='text-link'>排程</u></button>
                            </div>
                        </div>
                        <div class="row mt-3 text-left">
                            <div class="col text-left">
                                <button mat-button class="btn-delete" (click)="deleteProjectRequest()">刪除</button>
                                <!-- <button mat-button class="btn-delete"
                                    (click)="deletepluraltaskRequest()">刪除test</button> -->
                                <button mat-button class="btn-termination" (click)="editOneProjectDatas('已中止', '中止')"
                                    *ngIf="status != '已中止'">中止</button>
                            </div>
                        </div>
                        <div class="row mt-3" *ngIf="status != '專案已啟動'">
                            <div class="col text-left">
                                <button mat-button class="btn-save"
                                    (click)="editOneProjectDatas(status, '更新')">暫存</button>
                                <button mat-button class="btn-start"
                                    (click)="editOneProjectDatas('專案已啟動', '啟動')">啟動專案</button>
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col text-left">
                                <button mat-button class="btn-termination" (click)="editurl()">離開</button>
                            </div>
                        </div>
                    </mat-card>
                </div>
                <div class="col-9">
                    <mat-card class="card search-group right-card">
                        <p-tabView>
                            <p-tabPanel header="機台">
                                <div class="table-container">
                                    <div class="table text-left">
                                        <table mat-table [dataSource]="dataSource_1"
                                            class="mat-elevation-z8 demo-table">
                                            <!-- taskname Column -->
                                            <ng-container matColumnDef="taskname">
                                                <th mat-header-cell class="table-taskname label-Required"
                                                    *matHeaderCellDef>
                                                    項目
                                                </th>
                                                <td mat-cell class="table-taskname" *matCellDef="let element">
                                                    <button mat-button
                                                        (click)="AddTaskUsers(element.t_id, element.taskname)"><u
                                                            class='text-link'>{{element.taskname}}</u></button>
                                                </td>
                                            </ng-container>

                                            <!-- date_for_estimated_start Column -->
                                            <ng-container matColumnDef="date_for_estimated_start_1">
                                                <th mat-header-cell
                                                    class="table-date_for_estimated_start label-Required"
                                                    *matHeaderCellDef>
                                                    預計起始日
                                                </th>
                                                <td mat-cell class="table-date_for_estimated_start"
                                                    *matCellDef="let element; let index = index">
                                                    <mat-form-field appearance="outline" style="width:125px">
                                                        <mat-label></mat-label>
                                                        <input matInput [matDatepicker]="picker" type="text"
                                                            name="date_for_estimated_start_1-{{index}}"
                                                            [(ngModel)]="element.date_for_estimated_start_1">
                                                        <mat-datepicker-toggle matSuffix [for]="picker">
                                                        </mat-datepicker-toggle>
                                                        <mat-datepicker #picker></mat-datepicker>
                                                    </mat-form-field>
                                                </td>
                                            </ng-container>

                                            <!-- date_for_estimated_completion Column -->
                                            <ng-container matColumnDef="date_for_estimated_completion_1">
                                                <th mat-header-cell
                                                    class="table-date_for_estimated_completion label-Required"
                                                    *matHeaderCellDef>
                                                    預計完成日
                                                </th>
                                                <td mat-cell class="table-date_for_estimated_completion"
                                                    *matCellDef="let element; let index = index">
                                                    <mat-form-field appearance="outline" style="width:125px">
                                                        <mat-label></mat-label>
                                                        <input matInput [matDatepicker]="picker" type="text"
                                                            name="date_for_estimated_completion_1-{{index}}"
                                                            [(ngModel)]="element.date_for_estimated_completion_1">
                                                        <mat-datepicker-toggle matSuffix [for]="picker">
                                                        </mat-datepicker-toggle>
                                                        <mat-datepicker #picker></mat-datepicker>
                                                    </mat-form-field>
                                                </td>
                                            </ng-container>

                                            <!-- date_for_actual_completion Column -->
                                            <ng-container matColumnDef="date_for_actual_completion_1">
                                                <th mat-header-cell class="table-date_for_actual_completion"
                                                    *matHeaderCellDef>
                                                    實際完成日
                                                </th>
                                                <td mat-cell class="table-date_for_actual_completion"
                                                    *matCellDef="let element">
                                                    <mat-form-field appearance="outline" style="width:95px">
                                                        <input matInput disabled value={{element.fillout}}>
                                                    </mat-form-field>
                                                </td>
                                            </ng-container>

                                            <!-- principal Column -->
                                            <ng-container matColumnDef="principal_1">
                                                <th mat-header-cell class="table-principal label-Required"
                                                    *matHeaderCellDef>
                                                    負責人</th>
                                                <td mat-cell class="table-principal"
                                                    *matCellDef="let element; let index = index">
                                                    <mat-form-field appearance="outline" style="width:140px">
                                                        <mat-select type="text" name="principal_1-{{index}}"
                                                            [(ngModel)]="element.principal_1" ngDefaultControl>
                                                            <mat-option *ngFor="let user of userList" [value]="user.id">
                                                                {{user.name}}
                                                            </mat-option>
                                                        </mat-select>
                                                    </mat-form-field>
                                                </td>
                                            </ng-container>



                                            <!-- file Column -->
                                            <ng-container matColumnDef="file_1">
                                                <th mat-header-cell class="table-appendix-principal label-Required"
                                                    *matHeaderCellDef>
                                                    是否外掛</th>
                                                <td mat-cell *matCellDef="let element; let index = index">
                                                    <mat-checkbox class="table-appendix-principal"
                                                        name="file_1-{{index}}" [(ngModel)]="element.file_1">附件
                                                    </mat-checkbox>
                                                </td>
                                            </ng-container>

                                            <!-- remark Column -->
                                            <ng-container matColumnDef="remark_1">
                                                <th mat-header-cell class="table-remark" *matHeaderCellDef>
                                                    備註
                                                </th>
                                                <td mat-cell class="table-remark"
                                                    *matCellDef="let element; let index = index">
                                                    <mat-form-field appearance="outline" style="width:105px">
                                                        <textarea matInput name="remark_1-{{index}}"
                                                            [(ngModel)]="element.remark_1"></textarea>
                                                    </mat-form-field>
                                                </td>
                                            </ng-container>

                                            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                                            <tr mat-row [class.demo-row-is-clicked]="clickedRows.has(row)"
                                                *matRowDef="let row; columns: displayedColumns;"></tr>
                                        </table>
                                    </div>
                                </div>
                            </p-tabPanel>
                            <p-tabPanel header="治具">
                                <div class="table-container">
                                    <div class="table text-left">
                                        <table mat-table [dataSource]="dataSource_2"
                                            class="mat-elevation-z8 demo-table">

                                            <!-- taskname Column -->
                                            <ng-container matColumnDef="taskname">
                                                <th mat-header-cell class="table-taskname" *matHeaderCellDef>
                                                    項目
                                                </th>
                                                <td mat-cell class="table-taskname" *matCellDef="let element">
                                                    {{element.taskname}}
                                                </td>
                                            </ng-container>

                                            <!-- date_for_estimated_start Column -->
                                            <ng-container matColumnDef="date_for_estimated_start_2">
                                                <th mat-header-cell class="table-date_for_estimated_start"
                                                    *matHeaderCellDef>
                                                    預計起始日
                                                </th>
                                                <td mat-cell class="table-date_for_estimated_start"
                                                    *matCellDef="let element; let index = index">
                                                    <mat-form-field appearance="outline" style="width:125px">
                                                        <mat-label></mat-label>
                                                        <input matInput [matDatepicker]="picker" type="text"
                                                            name="date_for_estimated_start_2-{{index}}"
                                                            [(ngModel)]="element.date_for_estimated_start_2">
                                                        <mat-datepicker-toggle matSuffix [for]="picker">
                                                        </mat-datepicker-toggle>
                                                        <mat-datepicker #picker></mat-datepicker>
                                                    </mat-form-field>
                                                </td>
                                            </ng-container>

                                            <!-- date_for_estimated_completion Column -->
                                            <ng-container matColumnDef="date_for_estimated_completion_2">
                                                <th mat-header-cell class="table-date_for_estimated_completion"
                                                    *matHeaderCellDef>
                                                    預計完成日
                                                </th>
                                                <td mat-cell class="table-date_for_estimated_completion"
                                                    *matCellDef="let element; let index = index">
                                                    <mat-form-field appearance="outline" style="width:125px">
                                                        <mat-label></mat-label>
                                                        <input matInput [matDatepicker]="picker" type="text"
                                                            name="date_for_estimated_completion_2-{{index}}"
                                                            [(ngModel)]="element.date_for_estimated_completion_2">
                                                        <mat-datepicker-toggle matSuffix [for]="picker">
                                                        </mat-datepicker-toggle>
                                                        <mat-datepicker #picker></mat-datepicker>
                                                    </mat-form-field>
                                                </td>
                                            </ng-container>

                                            <!-- date_for_actual_completion Column -->
                                            <ng-container matColumnDef="date_for_actual_completion_2">
                                                <th mat-header-cell class="table-date_for_actual_completion"
                                                    *matHeaderCellDef>
                                                    實際完成日
                                                </th>
                                                <td mat-cell class="table-date_for_actual_completion"
                                                    *matCellDef="let element">
                                                    <mat-form-field appearance="outline" style="width:95px">
                                                        <input matInput disabled
                                                            value={{element.date_for_actual_completion_2}}>
                                                    </mat-form-field>
                                                </td>
                                            </ng-container>

                                            <!-- principal Column -->
                                            <ng-container matColumnDef="principal_2">
                                                <th mat-header-cell class="table-principal" *matHeaderCellDef>
                                                    負責人</th>
                                                <td mat-cell class="table-principal"
                                                    *matCellDef="let element; let index = index">
                                                    <mat-form-field appearance="outline" style="width:140px">
                                                        <mat-select type="text" name="principal_2-{{index}}"
                                                            [(ngModel)]="element.principal_2" ngDefaultControl>
                                                            <mat-option *ngFor="let user of userList" [value]="user.id">
                                                                {{user.name}}
                                                            </mat-option>
                                                        </mat-select>
                                                    </mat-form-field>
                                                </td>
                                            </ng-container>

                                            <!-- file Column -->
                                            <ng-container matColumnDef="file_2">
                                                <th mat-header-cell class="table-appendix-principal" *matHeaderCellDef>
                                                    是否外掛</th>
                                                <td mat-cell *matCellDef="let element; let index = index">
                                                    <mat-checkbox class="table-appendix-principal"
                                                        name="file_2-{{index}}" [(ngModel)]="element.file_2">附件
                                                    </mat-checkbox>
                                                </td>
                                            </ng-container>

                                            <!-- remark Column -->
                                            <ng-container matColumnDef="remark_2">
                                                <th mat-header-cell class="table-remark" *matHeaderCellDef>
                                                    備註
                                                </th>
                                                <td mat-cell class="table-remark"
                                                    *matCellDef="let element; let index = index">
                                                    <mat-form-field appearance="outline" style="width:105px">
                                                        <textarea matInput name="remark_2-{{index}}"
                                                            [(ngModel)]="element.remark_2"></textarea>
                                                    </mat-form-field>
                                                </td>
                                            </ng-container>

                                            <tr mat-header-row *matHeaderRowDef="displayedColumns_2"></tr>
                                            <tr mat-row [class.demo-row-is-clicked]="clickedRows_2.has(row)"
                                                *matRowDef="let row; columns: displayedColumns_2;"></tr>
                                        </table>
                                    </div>
                                </div>
                            </p-tabPanel>
                            <p-tabPanel header="書面資料">
                                <div class="table-container">
                                    <div class="table text-left">
                                        <table mat-table [dataSource]="dataSource_3"
                                            class="mat-elevation-z8 demo-table">

                                            <!-- taskname Column -->
                                            <ng-container matColumnDef="taskname">
                                                <th mat-header-cell class="table-taskname" *matHeaderCellDef>
                                                    項目
                                                </th>
                                                <td mat-cell class="table-taskname" *matCellDef="let element">
                                                    <button mat-button
                                                        (click)="AddTaskUsers(element.t_id, element.taskname)"><u
                                                            class='text-link'>{{element.taskname}}</u></button>
                                                </td>
                                            </ng-container>

                                            <!-- date_for_estimated_start Column -->
                                            <ng-container matColumnDef="date_for_estimated_start_3">
                                                <th mat-header-cell class="table-date_for_estimated_start"
                                                    *matHeaderCellDef>
                                                    預計起始日
                                                </th>
                                                <td mat-cell class="table-date_for_estimated_start"
                                                    *matCellDef="let element; let index = index">
                                                    <mat-form-field appearance="outline" style="width:125px">
                                                        <mat-label></mat-label>
                                                        <input matInput [matDatepicker]="picker" type="text"
                                                            name="date_for_estimated_start_3-{{index}}"
                                                            [(ngModel)]="element.date_for_estimated_start_3">
                                                        <mat-datepicker-toggle matSuffix [for]="picker">
                                                        </mat-datepicker-toggle>
                                                        <mat-datepicker #picker></mat-datepicker>
                                                    </mat-form-field>
                                                </td>
                                            </ng-container>

                                            <!-- date_for_estimated_completion Column -->
                                            <ng-container matColumnDef="date_for_estimated_completion_3">
                                                <th mat-header-cell class="table-date_for_estimated_completion"
                                                    *matHeaderCellDef>
                                                    預計完成日
                                                </th>
                                                <td mat-cell class="table-date_for_estimated_completion"
                                                    *matCellDef="let element; let index = index">
                                                    <mat-form-field appearance="outline" style="width:125px">
                                                        <mat-label></mat-label>
                                                        <input matInput [matDatepicker]="picker" type="text"
                                                            name="date_for_estimated_completion_3-{{index}}"
                                                            [(ngModel)]="element.date_for_estimated_completion_3">
                                                        <mat-datepicker-toggle matSuffix [for]="picker">
                                                        </mat-datepicker-toggle>
                                                        <mat-datepicker #picker></mat-datepicker>
                                                    </mat-form-field>
                                                </td>
                                            </ng-container>

                                            <!-- date_for_actual_completion Column -->
                                            <ng-container matColumnDef="date_for_actual_completion_3">
                                                <th mat-header-cell class="table-date_for_actual_completion"
                                                    *matHeaderCellDef>
                                                    實際完成日
                                                </th>
                                                <td mat-cell class="table-date_for_actual_completion"
                                                    *matCellDef="let element">
                                                    <mat-form-field appearance="outline" style="width:95px">
                                                        <input matInput disabled
                                                            value={{element.date_for_actual_completion_3}}>
                                                    </mat-form-field>
                                                </td>
                                            </ng-container>

                                            <!-- principal Column -->
                                            <ng-container matColumnDef="principal_3">
                                                <th mat-header-cell class="table-principal" *matHeaderCellDef>
                                                    負責人</th>
                                                <td mat-cell class="table-principal"
                                                    *matCellDef="let element; let index = index">
                                                    <mat-form-field appearance="outline" style="width:140px">
                                                        <mat-select type="text" name="principal_3-{{index}}"
                                                            [(ngModel)]="element.principal_3" ngDefaultControl>
                                                            <mat-option *ngFor="let user of userList" [value]="user.id">
                                                                {{user.name}}
                                                            </mat-option>
                                                        </mat-select>
                                                    </mat-form-field>
                                                </td>
                                            </ng-container>

                                            <!-- file Column -->
                                            <ng-container matColumnDef="file_3">
                                                <th mat-header-cell class="table-appendix-principal" *matHeaderCellDef>
                                                    是否外掛</th>
                                                <td mat-cell *matCellDef="let element; let index = index">
                                                    <mat-checkbox class="table-appendix-principal"
                                                        name="file_3-{{index}}" [(ngModel)]="element.file_3">附件
                                                    </mat-checkbox>
                                                </td>
                                            </ng-container>

                                            <!-- remark Column -->
                                            <ng-container matColumnDef="remark_3">
                                                <th mat-header-cell class="table-remark" *matHeaderCellDef>
                                                    備註
                                                </th>
                                                <td mat-cell class="table-remark"
                                                    *matCellDef="let element; let index = index">
                                                    <mat-form-field appearance="outline" style="width:105px">
                                                        <textarea matInput name="remark_3-{{index}}"
                                                            [(ngModel)]="element.remark_3"></textarea>
                                                    </mat-form-field>
                                                </td>
                                            </ng-container>

                                            <tr mat-header-row *matHeaderRowDef="displayedColumns_3"></tr>
                                            <tr mat-row [class.demo-row-is-clicked]="clickedRows_3.has(row)"
                                                *matRowDef="let row; columns: displayedColumns_3;"></tr>
                                        </table>
                                    </div>
                                </div>
                            </p-tabPanel>
                            <p-tabPanel header="試機需求部品">
                                <div class="table-container">
                                    <div class="table text-left">
                                        <table mat-table [dataSource]="dataSource_4"
                                            class="mat-elevation-z8 demo-table">

                                            <!-- taskname Column -->
                                            <ng-container matColumnDef="taskname">
                                                <th mat-header-cell class="table-taskname_4" *matHeaderCellDef>
                                                    項目
                                                </th>
                                                <td mat-cell class="table-taskname_4" *matCellDef="let element">
                                                    {{element.taskname}}
                                                </td>
                                            </ng-container>

                                            <!-- quantity Column -->
                                            <ng-container matColumnDef="quantity">
                                                <th mat-header-cell class="table-quantity" *matHeaderCellDef>
                                                    規格/數量</th>
                                                <td mat-cell class="table-quantity"
                                                    *matCellDef="let element; let index = index">
                                                    <mat-form-field appearance="outline" style="width:75px">
                                                        <input matInput class="table-quantity-input" type="text"
                                                            name="quantity-{{index}}" [(ngModel)]="element.quantity">
                                                    </mat-form-field>
                                                </td>
                                            </ng-container>

                                            <!-- date_for_estimated_start Column -->
                                            <ng-container matColumnDef="date_for_estimated_start_4">
                                                <th mat-header-cell class="table-date_for_estimated_start"
                                                    *matHeaderCellDef>
                                                    預計起始日
                                                </th>
                                                <td mat-cell class="table-date_for_estimated_start"
                                                    *matCellDef="let element; let index = index">
                                                    <mat-form-field appearance="outline" style="width:125px">
                                                        <mat-label></mat-label>
                                                        <input matInput [matDatepicker]="picker" type="text"
                                                            name="date_for_estimated_start_4-{{index}}"
                                                            [(ngModel)]="element.date_for_estimated_start_4">
                                                        <mat-datepicker-toggle matSuffix [for]="picker">
                                                        </mat-datepicker-toggle>
                                                        <mat-datepicker #picker></mat-datepicker>
                                                    </mat-form-field>
                                                </td>
                                            </ng-container>

                                            <!-- date_for_estimated_completion Column -->
                                            <ng-container matColumnDef="date_for_estimated_completion_4">
                                                <th mat-header-cell class="table-date_for_estimated_completion"
                                                    *matHeaderCellDef>
                                                    預計完成日
                                                </th>
                                                <td mat-cell class="table-date_for_estimated_completion"
                                                    *matCellDef="let element; let index = index">
                                                    <mat-form-field appearance="outline" style="width:125px">
                                                        <mat-label></mat-label>
                                                        <input matInput [matDatepicker]="picker" type="text"
                                                            name="date_for_estimated_completion_4-{{index}}"
                                                            [(ngModel)]="element.date_for_estimated_completion_4">
                                                        <mat-datepicker-toggle matSuffix [for]="picker">
                                                        </mat-datepicker-toggle>
                                                        <mat-datepicker #picker></mat-datepicker>
                                                    </mat-form-field>
                                                </td>
                                            </ng-container>

                                            <!-- date_for_actual_completion Column -->
                                            <ng-container matColumnDef="date_for_actual_completion_4">
                                                <th mat-header-cell class="table-date_for_actual_completion"
                                                    *matHeaderCellDef>
                                                    實際完成日
                                                </th>
                                                <td mat-cell class="table-date_for_actual_completion"
                                                    *matCellDef="let element">
                                                    <mat-form-field appearance="outline" style="width:95px">
                                                        <input matInput disabled
                                                            value={{element.date_for_actual_completion_4}}>
                                                    </mat-form-field>
                                                </td>
                                            </ng-container>

                                            <!-- principal Column -->
                                            <ng-container matColumnDef="principal_4">
                                                <th mat-header-cell class="table-principal" *matHeaderCellDef>
                                                    負責人</th>
                                                <td mat-cell class="table-principal"
                                                    *matCellDef="let element; let index = index">
                                                    <mat-form-field appearance="outline" style="width:140px">
                                                        <mat-select type="text" name="principal_4-{{index}}"
                                                            [(ngModel)]="element.principal_4" ngDefaultControl>
                                                            <mat-option *ngFor="let user of userList" [value]="user.id">
                                                                {{user.name}}
                                                            </mat-option>
                                                        </mat-select>
                                                    </mat-form-field>
                                                </td>
                                            </ng-container>

                                            <!-- file Column -->
                                            <ng-container matColumnDef="file_4">
                                                <th mat-header-cell class="table-appendix-principal" *matHeaderCellDef>
                                                    是否外掛</th>
                                                <td mat-cell *matCellDef="let element; let index = index">
                                                    <mat-checkbox class="table-appendix-principal"
                                                        name="file_4-{{index}}" [(ngModel)]="element.file_4">附件
                                                    </mat-checkbox>
                                                </td>
                                            </ng-container>

                                            <!-- remark Column -->
                                            <ng-container matColumnDef="remark_4">
                                                <th mat-header-cell class="table-remark" *matHeaderCellDef>
                                                    備註
                                                </th>
                                                <td mat-cell class="table-remark"
                                                    *matCellDef="let element; let index = index">
                                                    <mat-form-field appearance="outline" style="width:105px">
                                                        <textarea matInput name="remark_4-{{index}}"
                                                            [(ngModel)]="element.remark_4"></textarea>
                                                    </mat-form-field>
                                                </td>
                                            </ng-container>

                                            <tr mat-header-row *matHeaderRowDef="displayedColumns_4"></tr>
                                            <tr mat-row [class.demo-row-is-clicked]="clickedRows_4.has(row)"
                                                *matRowDef="let row; columns: displayedColumns_4;"></tr>
                                        </table>
                                    </div>
                                </div>
                            </p-tabPanel>
                            <p-tabPanel header="其他">
                                <div class="table-container">
                                    <div class="table text-left">
                                        <table mat-table [dataSource]="dataSource_5"
                                            class="mat-elevation-z8 demo-table">

                                            <!-- taskname Column -->
                                            <ng-container matColumnDef="taskname">
                                                <th mat-header-cell class="table-taskname" *matHeaderCellDef>
                                                    項目
                                                </th>
                                                <td mat-cell class="table-taskname" *matCellDef="let element">
                                                    {{element.taskname}}
                                                </td>
                                            </ng-container>

                                            <!-- date_for_estimated_start Column -->
                                            <ng-container matColumnDef="date_for_estimated_start_5">
                                                <th mat-header-cell class="table-date_for_estimated_start"
                                                    *matHeaderCellDef>
                                                    預計起始日
                                                </th>
                                                <td mat-cell class="table-date_for_estimated_start"
                                                    *matCellDef="let element; let index = index">
                                                    <mat-form-field appearance="outline" style="width:125px">
                                                        <mat-label></mat-label>
                                                        <input matInput [matDatepicker]="picker" type="text"
                                                            name="date_for_estimated_start_5-{{index}}"
                                                            [(ngModel)]="element.date_for_estimated_start_5">
                                                        <mat-datepicker-toggle matSuffix [for]="picker">
                                                        </mat-datepicker-toggle>
                                                        <mat-datepicker #picker></mat-datepicker>
                                                    </mat-form-field>
                                                </td>
                                            </ng-container>

                                            <!-- date_for_estimated_completion Column -->
                                            <ng-container matColumnDef="date_for_estimated_completion_5">
                                                <th mat-header-cell class="table-date_for_estimated_completion"
                                                    *matHeaderCellDef>
                                                    預計完成日
                                                </th>
                                                <td mat-cell class="table-date_for_estimated_completion"
                                                    *matCellDef="let element; let index = index">
                                                    <mat-form-field appearance="outline" style="width:125px">
                                                        <mat-label></mat-label>
                                                        <input matInput [matDatepicker]="picker" type="text"
                                                            name="date_for_estimated_completion_5-{{index}}"
                                                            [(ngModel)]="element.date_for_estimated_completion_5">
                                                        <mat-datepicker-toggle matSuffix [for]="picker">
                                                        </mat-datepicker-toggle>
                                                        <mat-datepicker #picker></mat-datepicker>
                                                    </mat-form-field>
                                                </td>
                                            </ng-container>

                                            <!-- date_for_actual_completion Column -->
                                            <ng-container matColumnDef="date_for_actual_completion_5">
                                                <th mat-header-cell class="table-date_for_actual_completion"
                                                    *matHeaderCellDef>
                                                    實際完成日
                                                </th>
                                                <td mat-cell class="table-date_for_actual_completion"
                                                    *matCellDef="let element">
                                                    <mat-form-field appearance="outline" style="width:95px">
                                                        <input matInput disabled
                                                            value={{element.date_for_actual_completion_5}}>
                                                    </mat-form-field>
                                                </td>
                                            </ng-container>

                                            <!-- principal Column -->
                                            <ng-container matColumnDef="principal_5">
                                                <th mat-header-cell class="table-principal" *matHeaderCellDef>
                                                    負責人</th>
                                                <td mat-cell class="table-principal"
                                                    *matCellDef="let element; let index = index">
                                                    <mat-form-field appearance="outline" style="width:140px">
                                                        <mat-select type="text" name="principal_5-{{index}}"
                                                            [(ngModel)]="element.principal_5" ngDefaultControl>
                                                            <mat-option *ngFor="let user of userList" [value]="user.id">
                                                                {{user.name}}
                                                            </mat-option>
                                                        </mat-select>
                                                    </mat-form-field>
                                                </td>
                                            </ng-container>

                                            <!-- file Column -->
                                            <ng-container matColumnDef="file_5">
                                                <th mat-header-cell class="table-appendix-principal" *matHeaderCellDef>
                                                    是否外掛</th>
                                                <td mat-cell *matCellDef="let element; let index = index">
                                                    <mat-checkbox class="table-appendix-principal"
                                                        name="file_5-{{index}}" [(ngModel)]="element.file_5">附件
                                                    </mat-checkbox>
                                                </td>
                                            </ng-container>

                                            <!-- remark Column -->
                                            <ng-container matColumnDef="remark_5">
                                                <th mat-header-cell class="table-remark" *matHeaderCellDef>
                                                    備註
                                                </th>
                                                <td mat-cell class="table-remark"
                                                    *matCellDef="let element; let index = index">
                                                    <mat-form-field appearance="outline" style="width:105px">
                                                        <textarea matInput name="remark_5-{{index}}"
                                                            [(ngModel)]="element.remark_5"></textarea>
                                                    </mat-form-field>
                                                </td>
                                            </ng-container>

                                            <tr mat-header-row *matHeaderRowDef="displayedColumns_5"></tr>
                                            <tr mat-row [class.demo-row-is-clicked]="clickedRows_5.has(row)"
                                                *matRowDef="let row; columns: displayedColumns_5;"></tr>
                                        </table>
                                        <button disabled mat-button
                                            (click)="addAntivirusSoftwareItem()">新增防毒軟體：</button>
                                        <div class="row" *ngIf="as_status == 'add'">
                                            <div class="col">
                                                <!-- as_name Column -->
                                                <mat-form-field appearance="outline">
                                                    <mat-label>軟體名稱</mat-label>
                                                    <input matInput type="text" [(ngModel)]="as_name" name="as_name"
                                                        ngDefaultControl>
                                                </mat-form-field>
                                                <!-- software_number Column -->
                                                <mat-form-field appearance="outline">
                                                    <mat-label>軟體序號</mat-label>
                                                    <input matInput type="text" [(ngModel)]="software_number"
                                                        name="software_number" ngDefaultControl>
                                                </mat-form-field>
                                                <!-- machine_number Column -->
                                                <mat-form-field appearance="outline">
                                                    <mat-label>總成</mat-label>
                                                    <input matInput type="text" [(ngModel)]="machine_number"
                                                        name="machine_number" ngDefaultControl>
                                                </mat-form-field>
                                                <button mat-button class="btn-normal-none"
                                                    (click)="uploadAntivirusSoftwareDatas()">儲存</button>
                                                <button mat-button class="btn-normal"
                                                    (click)="CancelDatas()">取消</button>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col">
                                                <table mat-table [dataSource]="antivirussoftwareSource">
                                                    <!-- as_name -->
                                                    <ng-container matColumnDef="as_name">
                                                        <th mat-header-cell *matHeaderCellDef>軟體名稱</th>
                                                        <td mat-cell *matCellDef="let element">
                                                            {{element.as_name}}
                                                        </td>
                                                    </ng-container>
                                                    <!-- software_number -->
                                                    <ng-container matColumnDef="software_number">
                                                        <th mat-header-cell *matHeaderCellDef>軟體序號</th>
                                                        <td mat-cell *matCellDef="let element">
                                                            {{element.software_number}}
                                                        </td>
                                                    </ng-container>
                                                    <!-- machine_number -->
                                                    <ng-container matColumnDef="machine_number">
                                                        <th mat-header-cell *matHeaderCellDef>機台序號</th>
                                                        <td mat-cell *matCellDef="let element">
                                                            {{element.machine_number}}
                                                        </td>
                                                    </ng-container>
                                                    <!-- create_time -->
                                                    <ng-container matColumnDef="create_time">
                                                        <th mat-header-cell *matHeaderCellDef>建檔日期</th>
                                                        <td mat-cell *matCellDef="let element">
                                                            {{element.create_time | date: 'yyyy/MM/dd hh:mm'}}
                                                        </td>
                                                    </ng-container>
                                                    <!-- delete -->
                                                    <ng-container matColumnDef="delete">
                                                        <th mat-header-cell *matHeaderCellDef class="text-center">
                                                            刪除 </th>
                                                        <td mat-cell *matCellDef="let element;let index = index"
                                                            class="text-center">
                                                            <button mat-mini-fab color="basic" class="table-btn-none"
                                                                (click)="deleteAntivirusSoftwareDatas(element.as_id)">
                                                                <mat-icon>delete</mat-icon>
                                                            </button>
                                                        </td>
                                                    </ng-container>
                                                    <tr mat-header-row *matHeaderRowDef="antivirussoftwareColumns">
                                                    </tr>
                                                    <tr mat-row
                                                        *matRowDef="let row; columns: antivirussoftwareColumns;">
                                                    </tr>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </p-tabPanel>
                            <p-tabPanel header="組合機次階">
                                <div class="table-container">
                                    <div class="table text-left">
                                        <!-- mc_code Column -->
                                        <mat-form-field appearance="outline">
                                            <mat-label>專案代號</mat-label>
                                            <input matInput type="text" [(ngModel)]="mc_code" name="mc_code"
                                                ngDefaultControl>
                                        </mat-form-field>
                                        <!-- mc_number Column -->
                                        <mat-form-field appearance="outline" class="table-date_for_actual_completion">
                                            <mat-label>數量</mat-label>
                                            <input matInput type="text" [(ngModel)]="mc_number" name="mc_number"
                                                ngDefaultControl>
                                        </mat-form-field>
                                        <!-- mc_finished Column -->
                                        <mat-form-field appearance="outline">
                                            <mat-label>總成</mat-label>
                                            <input matInput type="text" [(ngModel)]="mc_finished" name="mc_finished"
                                                ngDefaultControl>
                                        </mat-form-field>
                                        <!-- last_mc Column -->
                                        <mat-form-field appearance="outline" *ngIf="mc_status == 'add'">
                                            <mat-label>前次專案</mat-label>
                                            <mat-select [(ngModel)]="last_mc" name="last_mc" ngDefaultControl>
                                                <mat-option *ngFor="let mcData of mcDatas" [value]="mcData.mc_id">
                                                    {{mcData.mc_code}}
                                                </mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                        <!-- last_mc Column -->
                                        <mat-form-field appearance="outline" *ngIf="mc_status == 'edit'">
                                            <mat-label>前次專案</mat-label>
                                            <mat-select [(ngModel)]="last_mc" name="last_mc" ngDefaultControl>
                                                <mat-option *ngFor="let editData of editmclist"
                                                    [value]="editData.mc_id">
                                                    {{editData.mc_code}}
                                                </mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                        <button mat-button class="btn-normal-none" (click)="uploadMachineDatas()"
                                            *ngIf="mc_status == 'add'">儲存</button>
                                        <button mat-button class="btn-normal-none" (click)="editMachineDatas()"
                                            *ngIf="mc_status == 'edit'">儲存</button>
                                        <button mat-button class="btn-normal" (click)="CancelDatas()">取消</button>
                                        <table mat-table [dataSource]="machinecombinedSource">
                                            <!-- mc_code -->
                                            <ng-container matColumnDef="mc_code">
                                                <th mat-header-cell *matHeaderCellDef>專案代號</th>
                                                <td mat-cell *matCellDef="let element">
                                                    {{element.mc_code}}
                                                </td>
                                            </ng-container>
                                            <!-- mc_number -->
                                            <ng-container matColumnDef="mc_number">
                                                <th mat-header-cell *matHeaderCellDef>數量</th>
                                                <td mat-cell *matCellDef="let element">
                                                    {{element.mc_number}}
                                                </td>
                                            </ng-container>
                                            <!-- mc_finished -->
                                            <ng-container matColumnDef="mc_finished">
                                                <th mat-header-cell *matHeaderCellDef>總成</th>
                                                <td mat-cell *matCellDef="let element">
                                                    {{element.mc_finished}}
                                                </td>
                                            </ng-container>
                                            <!-- last_mc_code -->
                                            <ng-container matColumnDef="last_mc_code">
                                                <th mat-header-cell *matHeaderCellDef>前一任務</th>
                                                <td mat-cell *matCellDef="let element">
                                                    {{element.last_mc_code}}
                                                </td>
                                            </ng-container>
                                            <!--action_edit-->
                                            <ng-container matColumnDef="action_edit">
                                                <th mat-header-cell *matHeaderCellDef class="text-center">
                                                    編輯 </th>
                                                <td mat-cell *matCellDef="let element;let index = index"
                                                    class="text-center">
                                                    <button mat-mini-fab color="basic" class="table-btn-none"
                                                        (click)="getOneMachineDatas(element.mc_id)">
                                                        <mat-icon>edit</mat-icon>
                                                    </button>
                                                </td>
                                            </ng-container>
                                            <!-- delete -->
                                            <ng-container matColumnDef="delete">
                                                <th mat-header-cell *matHeaderCellDef class="text-center">
                                                    刪除 </th>
                                                <td mat-cell *matCellDef="let element;let index = index"
                                                    class="text-center">
                                                    <button mat-mini-fab color="basic" class="table-btn-none"
                                                        (click)="deleteOneMachineDatas(element.mc_id)">
                                                        <mat-icon>delete</mat-icon>
                                                    </button>
                                                </td>
                                            </ng-container>
                                            <tr mat-header-row *matHeaderRowDef="machinecombinedColumns">
                                            </tr>
                                            <tr mat-row *matRowDef="let row; columns: machinecombinedColumns;">
                                            </tr>
                                        </table>
                                    </div>
                                </div>
                            </p-tabPanel>
                            <p-tabPanel header="外掛部品">
                                <div class="row">
                                    <div class="col">
                                        <mat-form-field appearance="outline" style="width:300px">
                                            <mat-label></mat-label>
                                            <textarea matInput [(ngModel)]="content" name="content"
                                                ngDefaultControl></textarea>
                                        </mat-form-field>
                                        <button mat-button class="btn-normal-none"
                                            (click)="uploadPlugInDatas()">儲存</button>
                                        <button mat-button class="btn-normal" (click)="CancelDatas()">取消</button>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col">
                                        <div class="table-container">
                                            <div class="table text-left">
                                                <table mat-table [dataSource]="pluginSource">
                                                    <!-- content -->
                                                    <ng-container matColumnDef="content">
                                                        <th mat-header-cell *matHeaderCellDef>需求內容</th>
                                                        <td mat-cell *matCellDef="let element">
                                                            {{element.content}}
                                                        </td>
                                                    </ng-container>
                                                    <!-- delete -->
                                                    <ng-container matColumnDef="delete">
                                                        <th mat-header-cell *matHeaderCellDef class="text-center">
                                                            刪除 </th>
                                                        <td mat-cell *matCellDef="let element;let index = index"
                                                            class="text-center">
                                                            <button mat-mini-fab color="basic" class="table-btn-none"
                                                                (click)="deletePlugInDatas(element.pi_id)">
                                                                <mat-icon>delete</mat-icon>
                                                            </button>
                                                        </td>
                                                    </ng-container>
                                                    <tr mat-header-row *matHeaderRowDef="pluginColumns">
                                                    </tr>
                                                    <tr mat-row *matRowDef="let row; columns: pluginColumns;">
                                                    </tr>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </p-tabPanel>
                            <p-tabPanel header="相關紀錄">
                                <div class="table-container">
                                    <div class="table text-left">
                                        <div class="row pt-3" style="margin-bottom: -15px;">
                                            <div class="col-md-5">
                                                <mat-list>
                                                    <mat-list-item class="signoff_process_content">
                                                        <h4>建檔者：</h4>
                                                        <h4 class="text-context" class="name" style="color:#3f51b5;">
                                                            {{creater}}</h4>
                                                    </mat-list-item>
                                                </mat-list>
                                            </div>
                                            <div class="col-md-7">
                                                <mat-list>
                                                    <mat-list-item class="signoff_process_content">
                                                        <h4>建檔日期：</h4>
                                                        <h4 class="text-context" class="name" style="color:#3f51b5;">
                                                            {{createtime | date: 'yyyy/MM/dd hh:mm'}}</h4>
                                                    </mat-list-item>
                                                </mat-list>
                                            </div>
                                        </div>
                                        <div class="row pt-3">
                                            <div class="col">
                                                異動紀錄:
                                                <table mat-table [dataSource]="transactionSource">
                                                    <!-- creater_name -->
                                                    <ng-container matColumnDef="creater_name">
                                                        <th mat-header-cell *matHeaderCellDef>異動者</th>
                                                        <td mat-cell *matCellDef="let element">
                                                            {{element.creater_name}}
                                                        </td>
                                                    </ng-container>
                                                    <!-- create_time -->
                                                    <ng-container matColumnDef="create_time">
                                                        <th mat-header-cell *matHeaderCellDef>時間</th>
                                                        <td mat-cell *matCellDef="let element">
                                                            {{element.create_time | date: 'yyyy/MM/dd hh:mm'}}
                                                        </td>
                                                    </ng-container>
                                                    <!-- actor -->
                                                    <ng-container matColumnDef="actor">
                                                        <th mat-header-cell *matHeaderCellDef>狀態</th>
                                                        <td mat-cell *matCellDef="let element">
                                                            {{element.actor}}
                                                        </td>
                                                    </ng-container>
                                                    <!-- content -->
                                                    <ng-container matColumnDef="content">
                                                        <th mat-header-cell *matHeaderCellDef>內容</th>
                                                        <td mat-cell *matCellDef="let element">
                                                            {{element.content}}
                                                        </td>
                                                    </ng-container>
                                                    <tr mat-header-row *matHeaderRowDef="transactionColumns">
                                                    </tr>
                                                    <tr mat-row *matRowDef="let row; columns: transactionColumns;">
                                                    </tr>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </p-tabPanel>
                            <!-- 尚未開放 -->
                            <p-tabPanel header="附贈明細" *ngIf="">
                                <div class="row mt-3">
                                    <mat-form-field appearance="outline" style="width:400px">
                                        <mat-label>附贈說明</mat-label>
                                        <input matInput type="text" #filter placeholder="">
                                    </mat-form-field>
                                </div>
                                <div class="row mt-5">
                                    <mat-form-field appearance="outline" style="width:175px;">
                                        <mat-label>品號</mat-label>
                                        <input matInput type="text" #filter placeholder="請輸入關鍵字">
                                    </mat-form-field>
                                    <mat-form-field appearance="outline" style="width:200px;">
                                        <mat-label>品名</mat-label>
                                        <input matInput type="text" #filter placeholder="請輸入關鍵字">
                                    </mat-form-field>
                                    <mat-form-field appearance="outline" style="width:350px;">
                                        <mat-label>規格</mat-label>
                                        <input matInput type="text" #filter placeholder="請輸入關鍵字">
                                    </mat-form-field>
                                    <mat-form-field appearance="outline" style="width:100px;">
                                        <mat-label>數量</mat-label>
                                        <input matInput type="text" #filter placeholder="請輸入關鍵字">
                                    </mat-form-field>
                                </div>
                                <div class="row mt-2">
                                    <div class="table-container">
                                        <div class="table text-left">
                                            <table mat-table [dataSource]="dataSource_7_1"
                                                class="mat-elevation-z8 demo-table">

                                                <!-- item_number Column -->
                                                <ng-container matColumnDef="item_number">
                                                    <th mat-header-cell *matHeaderCellDef>品號</th>
                                                    <td mat-cell *matCellDef="let element">
                                                        {{element.item_number}}</td>
                                                </ng-container>

                                                <!-- product_id Column -->
                                                <ng-container matColumnDef="product_id">
                                                    <th mat-header-cell *matHeaderCellDef>品名</th>
                                                    <td mat-cell *matCellDef="let element">
                                                        {{element.product_id}}</td>
                                                </ng-container>

                                                <!-- specification Column -->
                                                <ng-container matColumnDef="specification">
                                                    <th mat-header-cell *matHeaderCellDef>規格</th>
                                                    <td mat-cell *matCellDef="let element">
                                                        {{element.specification}}</td>
                                                </ng-container>

                                                <!-- quantity_7 Column -->
                                                <ng-container matColumnDef="quantity_7">
                                                    <th mat-header-cell *matHeaderCellDef>數量</th>
                                                    <td mat-cell *matCellDef="let element">
                                                        {{element.quantity_7}}</td>
                                                </ng-container>


                                                <tr mat-header-row *matHeaderRowDef="displayedColumns_7_1"></tr>
                                                <tr mat-row [class.demo-row-is-clicked]="clickedRows_7_1.has(row)"
                                                    *matRowDef="let row; columns: displayedColumns_7_1;"></tr>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                                <div class="row mt-5">
                                    <div class="table-container">
                                        <div class="table text-left">
                                            <table mat-table [dataSource]="dataSource_7_2"
                                                class="mat-elevation-z8 demo-table">

                                                <!-- requisiton_number Column -->
                                                <ng-container matColumnDef="requisiton_number">
                                                    <th mat-header-cell *matHeaderCellDef>申請單號</th>
                                                    <td mat-cell *matCellDef="let element">
                                                        {{element.requisiton_number}}</td>
                                                </ng-container>

                                                <!-- application_date Column -->
                                                <ng-container matColumnDef="application_date">
                                                    <th mat-header-cell *matHeaderCellDef>申請日期</th>
                                                    <td mat-cell *matCellDef="let element">
                                                        {{element.application_date}}</td>
                                                </ng-container>

                                                <!-- applicant Column -->
                                                <ng-container matColumnDef="applicant">
                                                    <th mat-header-cell *matHeaderCellDef>申請者</th>
                                                    <td mat-cell *matCellDef="let element">{{element.applicant}}
                                                    </td>
                                                </ng-container>

                                                <!-- file_creator Column -->
                                                <ng-container matColumnDef="file_creator">
                                                    <th mat-header-cell *matHeaderCellDef>建檔者</th>
                                                    <td mat-cell *matCellDef="let element">
                                                        {{element.file_creator}}</td>
                                                </ng-container>

                                                <!-- customer Column -->
                                                <ng-container matColumnDef="customer">
                                                    <th mat-header-cell *matHeaderCellDef>客戶別</th>
                                                    <td mat-cell *matCellDef="let element">{{element.customer}}
                                                    </td>
                                                </ng-container>

                                                <!-- project_code_7 Column -->
                                                <ng-container matColumnDef="project_code_7">
                                                    <th mat-header-cell *matHeaderCellDef>專案代號</th>
                                                    <td mat-cell *matCellDef="let element">
                                                        {{element.project_code_7}}</td>
                                                </ng-container>

                                                <!-- requisition Column -->
                                                <ng-container matColumnDef="requisition">
                                                    <th mat-header-cell *matHeaderCellDef>請購單號</th>
                                                    <td mat-cell *matCellDef="let element">
                                                        {{element.requisition}}</td>
                                                </ng-container>

                                                <!-- apply Column -->
                                                <ng-container matColumnDef="apply">
                                                    <th mat-header-cell *matHeaderCellDef>申請</th>
                                                    <td mat-cell *matCellDef="let element">{{element.apply}}
                                                    </td>
                                                </ng-container>

                                                <!-- purchase Column -->
                                                <ng-container matColumnDef="purchase">
                                                    <th mat-header-cell *matHeaderCellDef>採購</th>
                                                    <td mat-cell *matCellDef="let element">{{element.purchase}}
                                                    </td>
                                                </ng-container>

                                                <!-- state Column -->
                                                <ng-container matColumnDef="state">
                                                    <th mat-header-cell *matHeaderCellDef>狀態</th>
                                                    <td mat-cell *matCellDef="let element">{{element.state}}
                                                    </td>
                                                </ng-container>

                                                <tr mat-header-row *matHeaderRowDef="displayedColumns_7_2"></tr>
                                                <tr mat-row [class.demo-row-is-clicked]="clickedRows_7_2.has(row)"
                                                    *matRowDef="let row; columns: displayedColumns_7_2;"></tr>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </p-tabPanel>
                        </p-tabView>
                    </mat-card>
                </div>
            </div>
        </div>
    </form>
</div>