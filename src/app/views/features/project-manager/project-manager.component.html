<div class="container">
    <div class="row">
        <div class="col-md-12">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="/main/dashboard">首頁</a></li>
                    <li class="breadcrumb-item active">專案計畫管理</li>
                    <li class="breadcrumb-item active" aria-current="page">專案管理作業</li>
                </ol>
            </nav>
        </div>
    </div>
    <!--標題-->
    <div class="row">
        <div class="col-md-12 text-center">
            <div class="left">
                <h1>
                    <mat-icon>description</mat-icon>
                    <span class="text-left">
                        專案管理作業
                    </span>
                </h1>
            </div>
        </div>
    </div>
    <!--查詢區域-->
    <div class="row">
        <div class="col-md-12 ">
            <div class="form-group pt-3 pb-0">
                <mat-card class="card search-group">
                    <!-- <mat-form-field appearance="outline">
                        <mat-label>專案分類</mat-label>
                        <mat-select name="projet-type" [formControl]="projectTypeTopping" multiple>
                            <mat-option *ngFor="let item of projectTypeToppingList" [value]="projectTypeTopping">{{item}}</mat-option>
                        </mat-select>
                    </mat-form-field> -->
                    <!-- <mat-form-field appearance="outline">
                        <mat-label>專案分類</mat-label>
                        <mat-select name="projet-type" [ngModel]="type">
                            <mat-option *ngFor="let item of projectType_option" [value]="item.text">
                                {{item.text}}
                            </mat-option>
                        </mat-select>
                    </mat-form-field> -->

                    <mat-form-field class="example-full-width" appearance="outline">
                        <mat-label>類別</mat-label>
                        <input type="text" (keyup)="applyFilter($event)" placeholder="專案分類" aria-label="專案分類" matInput
                            [matAutocomplete]="auto4">
                        <mat-autocomplete #auto4="matAutocomplete">
                            <mat-option *ngFor="let item of projectType_option" [value]="item">
                                {{item}}
                            </mat-option>
                        </mat-autocomplete>
                    </mat-form-field>
                    <!-- <mat-form-field appearance="outline">
                        <mat-label>狀態</mat-label>
                        <mat-select disableRipple  [ngModel]="status" (keyup)="applyFilter2($event)">
                            <mat-option *ngFor="let item of projectStatus_option" [value]="item.text">
                                {{item.text}}
                            </mat-option>
                        </mat-select>
                    </mat-form-field> -->

                    <mat-form-field class="example-full-width" appearance="outline">
                        <mat-label>狀態</mat-label>
                        <input type="text" (keyup)="applyFilter($event)" placeholder="狀態" aria-label="狀態" matInput
                            [formControl]="myControl" [matAutocomplete]="auto">
                        <mat-autocomplete #auto="matAutocomplete">
                            <mat-option *ngFor="let option of projectStatus_option" [value]="option">
                                {{option}}
                            </mat-option>
                        </mat-autocomplete>
                    </mat-form-field>

                    <mat-form-field class="example-full-width" appearance="outline">
                        <mat-label>負責人</mat-label>
                        <input type="text" (keyup)="applyFilter($event)" placeholder="專案負責人" aria-label="專案負責人" matInput
                            [matAutocomplete]="auto1">
                        <mat-autocomplete #auto1="matAutocomplete">
                            <mat-option *ngFor="let item of projectman_option" [value]="item">
                                {{item}}
                            </mat-option>
                        </mat-autocomplete>
                    </mat-form-field>

                    <mat-form-field class="example-full-width" appearance="outline">
                        <mat-label>客戶</mat-label>
                        <input type="text" (keyup)="applyFilter($event)" placeholder="客戶" aria-label="客戶" matInput
                            [matAutocomplete]="auto2">
                        <mat-autocomplete #auto2="matAutocomplete">
                            <mat-option *ngFor="let item of projectCustomer_option" [value]="item">
                                {{item}}
                            </mat-option>
                        </mat-autocomplete>
                    </mat-form-field>

                    <mat-form-field class="example-full-width" appearance="outline">
                        <mat-label>代號/名稱</mat-label>
                        <input type="text" (keyup)="applyFilter($event)" placeholder="專案代號/名稱" aria-label="專案代號/名稱"
                            matInput [matAutocomplete]="auto3">
                        <mat-autocomplete #auto3="matAutocomplete">
                            <mat-option *ngFor="let item of projectCode_option" [value]="item">
                                {{item}}
                            </mat-option>
                        </mat-autocomplete>
                    </mat-form-field>
                    <!-- <mat-form-field appearance="outline">
                        <mat-label>專案負責人</mat-label>
                        <mat-select disableRipple  [ngModel]="projectman_name" formControlName="projectman_name">
                            <mat-option *ngFor="let item of projectman_option" [value]="item.text">
                                {{item.text}}
                            </mat-option>
                        </mat-select>
                    </mat-form-field> -->

                    <!-- <mat-form-field appearance="outline">
                        <mat-label>狀態</mat-label>
                        <mat-select name="status" [formControl]="projectStatusTopping" multiple>
                            <mat-option *ngFor="let item of projectStatusToppingList" [value]="projectStatusTopping">{{item}}</mat-option>
                        </mat-select>
                    </mat-form-field> -->
                    <!-- <mat-form-field appearance="outline">
                        <mat-label>客戶</mat-label>
                        <input matInput (keyup)="applyFilter($event)" placeholder="輸入客戶" [(ngModel)]="value">
                        <button *ngIf="value" matSuffix mat-icon-button aria-label="Clear" (click)="value=''">
                            <mat-icon>close</mat-icon>
                        </button>
                    </mat-form-field> -->
                    <!-- <mat-form-field appearance="outline">
                        <mat-label>專案代號/名稱</mat-label>
                        <input matInput (keyup)="applyFilter($event)" placeholder="輸入專案代號/名稱" [(ngModel)]="projectnamevalue">
                        <button *ngIf="projectnamevalue" matSuffix mat-icon-button aria-label="Clear" (click)="projectnamevalue=''">
                            <mat-icon>close</mat-icon>
                        </button>
                    </mat-form-field> -->

                    <!-- <mat-form-field appearance="outline" style="width: 210px;">
                        <mat-label>時程</mat-label>
                        <mat-date-range-input [rangePicker]="picker">
                            <input matStartDate placeholder="專案起始日" matInput (keyup)="applyFilter($event)"
                                name="date_for_start">
                            <input matEndDate placeholder="專案結束日" matInput (keyup)="applyFilter($event)"
                                name="date_for_done">
                        </mat-date-range-input>
                        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                        <mat-date-range-picker #picker></mat-date-range-picker>
                    </mat-form-field> -->
                    
                    <!-- <button mat-button id="" class="btn-normal-none">查詢</button> -->
                </mat-card>
            </div>
        </div>
    </div>
    <!--查詢區域2 未命名-->
    <!-- <div class="row">
        <div class="col-md-12">
            <div class="form-group pt-0 pb-0">
                <mat-card class="card search-group">
                    <mat-form-field appearance="outline">
                        <mat-label>查詢時程</mat-label>
                        <mat-select disableRipple>
                            <mat-option value="上週">上週</mat-option>
                            <mat-option value="當週">當週</mat-option>
                        </mat-select>
                    </mat-form-field>
                    <mat-form-field appearance="outline">
                        <mat-label>查詢狀態</mat-label>
                        <mat-select disableRipple>
                            <mat-option value="未完成">未完成</mat-option>
                            <mat-option value="已暫停">已暫停</mat-option>
                            <mat-option value="已完工">已完工</mat-option>
                        </mat-select>
                    </mat-form-field>
                    <button mat-button class="btn-normal-none">進度查詢</button>
                    
                    
                    <button mat-button class="btn-normal-none">顯示</button>
                </mat-card>
            </div>
        </div>
    </div> -->
    <!--顯示資料區域-->
    <div class="row">
        <div class="col-md-12">
            <div class="form-group pt-0 pb-3">
                <!--表格-->
                <mat-card class="card table">
                    <!-- <mat-form-field appearance="outline" class="ml-0">
                        <mat-label>關鍵字搜尋</mat-label>
                        <input matInput (keyup)="applyFilter($event)" placeholder="Ex. E001" [(ngModel)]="value">
                        <button *ngIf="value" matSuffix mat-icon-button aria-label="Clear" (click)="value=''">
                            <mat-icon>close</mat-icon>
                        </button>
                    </mat-form-field> -->

                    <!-- <button mat-button class="btn-normal">工時查詢</button> -->
                    <button mat-button id="" class="btn" matRipple [matRippleUnbounded]="false" (click)="addItem()">
                        新增
                    </button>
                    <!-- <button mat-button id="" class="btn" matRipple [matRippleUnbounded]="false" (click)="addItem()">新增2</button> -->

                    <mat-form-field appearance="outline" class="ml-10">
                        <mat-label>選擇</mat-label>
                        <mat-select [(ngModel)]="selectedValue" [formControl]="toppings" multiple>
                            <mat-select-trigger>
                                <span *ngIf="toppings.value?.length > 1" class="choose-tips">
                                    已選擇 {{toppings.value.length - 0}} 項
                                </span>
                            </mat-select-trigger>
                            <mat-option *ngFor="let list of toppingList" [value]="list.value">
                                {{list.viewValue}}
                            </mat-option>
                        </mat-select>
                    </mat-form-field>

                    <div class="table-container">
                        <table mat-table [dataSource]="B1B2DataSource" class="mat-elevation-z8">
                            <!-- p_code -->
                            <ng-container matColumnDef="type">
                                <th mat-header-cell *matHeaderCellDef style="display: none;">類別</th>
                                <td mat-cell *matCellDef="let element" style="display: none;"> {{element.type}} </td>
                            </ng-container>
                            <!-- p_code -->
                            <ng-container matColumnDef="code">
                                <th mat-header-cell *matHeaderCellDef>代號</th>
                                <td mat-cell *matCellDef="let element"> {{element.code}} </td>
                            </ng-container>
                            <!-- project_name -->
                            <ng-container matColumnDef="p_name">
                                <th mat-header-cell *matHeaderCellDef>名稱</th>
                                <td mat-cell *matCellDef="let element"> {{element.p_name}} </td>
                            </ng-container>
                            <!-- customer_name -->
                            <ng-container matColumnDef="customer_name">
                                <th mat-header-cell *matHeaderCellDef> 客戶 </th>
                                <td mat-cell *matCellDef="let element"> {{element.customer_name}} </td>
                            </ng-container>
                            <!-- project_principal -->
                            <ng-container matColumnDef="projectman_name">
                                <th mat-header-cell *matHeaderCellDef> 負責人 </th>
                                <td mat-cell *matCellDef="let element"> {{element.projectman_name}} </td>
                            </ng-container>
                            <!-- serviceman_id -->
                            <ng-container matColumnDef="serviceman_name">
                                <th mat-header-cell *matHeaderCellDef> 客服 </th>
                                <td mat-cell *matCellDef="let element"> {{element.serviceman_name}} </td>
                            </ng-container>
                            <!-- date_for_start -->
                            <ng-container matColumnDef="date_for_start">
                                <th mat-header-cell *matHeaderCellDef> 起始 </th>
                                <td mat-cell *matCellDef="let element"> {{element.date_for_start | date: 'yyyy/MM/dd'}}
                                </td>
                            </ng-container>
                            <!-- date_for_end -->
                            <ng-container matColumnDef="date_for_end">
                                <th mat-header-cell *matHeaderCellDef> 結束 </th>
                                <td mat-cell *matCellDef="let element"> {{element.date_for_end | date: 'yyyy/MM/dd'}}
                                </td>
                            </ng-container>
                            <!-- act_complete_date -->
                            <!-- <ng-container matColumnDef="date_for_done">
                                <th mat-header-cell *matHeaderCellDef> 實際完成日 </th>
                                <td mat-cell *matCellDef="let element"> {{element.date_for_done}} </td>
                            </ng-container> -->
                            <!-- status -->
                            
                            <ng-container matColumnDef="status">
                                <th mat-header-cell *matHeaderCellDef> </th>
                                <td mat-cell *matCellDef="let element">
                                    <!-- <small  [ngClass]="{'bg-success' : (element.status == '執行中') , 'bg-danger' : (element.status == '已中止') , 'bg-warning' : (element.status =='審核中')}" 
                                            class=" border-radius-5 hight-light-color py-2px px-2">
                                        {{element.status}}
                                    </small> -->
                                    <!-- {{element.status}} -->
                                    <mat-icon class="none" matTooltip={{element.status}} [ngClass]="{'blue3' : (element.status == '建檔中') , 'green3' : (element.status == '執行中') ,
                                     'yellow3' : (element.status == '已中止') , 'red3' : (element.status == '待完工'), 'big' : (element.status == '已完工'), 'pause' : (element.status == '已暫停'), 'end' : (element.status == '已結案')}">
                                        circle
                                    </mat-icon>
                                </td>
                            </ng-container>

                            <ng-container matColumnDef="action_edit">
                                <th mat-header-cell *matHeaderCellDef> </th>
                                <td mat-cell *matCellDef="let element">
                                    <button mat-mini-fab color="basic" class="table-btn-none"
                                        (click)="editProjectPage(element.p_id)">
                                        <mat-icon>edit</mat-icon>
                                    </button>
                                </td>
                            </ng-container>
                            <ng-container matColumnDef="action_manufactrue">
                                <th mat-header-cell *matHeaderCellDef> </th>
                                <td mat-cell *matCellDef="let element">
                                    <button mat-mini-fab color="basic" class="table-btn-none"
                                        (click)="addManufactureOrder(element)">
                                        <mat-icon>list_alt</mat-icon>
                                    </button>
                                </td>
                            </ng-container>
                            <!-- <ng-container matColumnDef="create_time">
                                <th mat-header-cell *matHeaderCellDef> 細項 </th>
                                <td mat-cell *matCellDef="let element">
                                    <button mat-mini-fab color="basic" class="table-btn-none" (click)="detailItem()">
                                        <mat-icon>info</mat-icon>
                                    </button>
                                </td>
                            </ng-container> -->
                            <!-- action_edit -->
                            <!-- <ng-container matColumnDef="action_edit">
                                <th mat-header-cell *matHeaderCellDef style="width: 30px;" class="text-center"> 編輯 </th>
                                <td mat-cell *matCellDef="let element" class="text-center">
                                    <button mat-mini-fab color="basic" class="table-btn-none" (click)="editItem(element)">
                                        <mat-icon>edit</mat-icon>
                                    </button>
                                </td>
                            </ng-container> -->
                            <!-- action_manufacture_order_open -->
                            <!-- <ng-container matColumnDef="action_manufacture_order_open" >
                                <th mat-header-cell *matHeaderCellDef style="width: 30px;" class="text-center"> 製令 </th>
                                <td mat-cell *matCellDef="let element" class="text-center">
                                    <button mat-mini-fab color="basic" class="table-btn-none" (click)="addManufactureOrder(element)">
                                        <mat-icon>list_alt</mat-icon>
                                    </button>
                                </td>
                            </ng-container> -->
                            <!-- action_detail -->
                            <!-- <ng-container matColumnDef="action_detail">
                                <th mat-header-cell *matHeaderCellDef style="width: 30px;" class="text-center"> 檢視 </th>
                                <td mat-cell *matCellDef="let element" >
                                    <button mat-mini-fab color="basic" class="table-btn-none" (click)="detailItem()">
                                        <mat-icon>info</mat-icon>
                                    </button>
                                </td>
                            </ng-container> -->
                            <tr mat-header-row *matHeaderRowDef="selectedValue"></tr>
                            <tr mat-row *matRowDef="let row; columns: selectedValue;"></tr>

                            <!-- Row shown when there is no matching data. -->
                        </table>
                    </div>
                    <mat-paginator #paginator [length]="totalCount" [pageIndex]="0" [pageSize]="5"
                        [pageSizeOptions]="[5, 10, 15]" [showFirstLastButtons]="true">
                    </mat-paginator>
                    <!-- 比較基準 -->
                    <h6>
                        比較基準:
                        <mat-icon class="blue3">circle</mat-icon>
                        建檔中
                        <mat-icon class="green3">circle</mat-icon>
                        執行中
                        <mat-icon class="red3">circle</mat-icon>
                        待完工
                        <mat-icon class="yellow3">circle</mat-icon>
                        已完工/已中止/已暫停/已結案
                        <!-- <mat-icon class="yellow3">circle</mat-icon>
                        
                        <mat-icon class="yellow3">circle</mat-icon>
                        已暫停
                        <mat-icon class="yellow3">circle</mat-icon>
                        已結案 -->
                    </h6>
                </mat-card>
            </div>
        </div>
    </div>

    <ng-template #addDialog>
        <app-add-dialog title=""></app-add-dialog>
    </ng-template>

    <ng-template #add2Dialog>
        <app-add2-dialog title=""></app-add2-dialog>
    </ng-template>

    <ng-template #detailDialog>
        <app-detail-dialog title=""></app-detail-dialog>
    </ng-template>
    <div class="row pb-4">
        <div class="col-md-3 text-center" *ngIf="set">
            <mat-card class="card p-5 analyze-item items-center justify-col analyze-item-content">
                <button class="analyze-btn">
                    <mat-icon>assignment</mat-icon>
                </button>
                <h3 class="mt-3 text-32" *ngIf="set">
                    {{set}}
                </h3>
                <p class="analyze-text m-0">建檔中專案</p>
            </mat-card>
        </div>

        <div class="col-md-3 text-center" *ngIf="run">
            <mat-card class="card p-5 analyze-item items-center justify-col analyze-item-content">
                <button class="analyze-btn">
                    <mat-icon>directions_run</mat-icon>
                </button>
                <h3 class="mt-3 text-32">
                    {{run}}
                </h3>
                <p class="analyze-text m-0">執行中專案</p>
            </mat-card>
        </div>

        <div class="col-md-3 text-center" *ngIf="review">
            <mat-card class="card p-5 analyze-item items-center justify-col analyze-item-content">
                <button class="analyze-btn">
                    <mat-icon>assignment_turned_in</mat-icon>
                </button>
                <h3 class="mt-3 text-32">
                    {{review}}
                </h3>
                <p class="analyze-text m-0">審核中專案</p>
            </mat-card>
        </div>
        <div class="col-md-3 text-center" *ngIf="stop">
            <mat-card class="card p-5 analyze-item items-center justify-col analyze-item-content">
                <button class="analyze-btn">
                    <mat-icon>block</mat-icon>
                </button>
                <h3 class="mt-3 text-32">
                    {{stop}}
                </h3>
                <p class="analyze-text m-0">已中止專案</p>
            </mat-card>
        </div>
        <div class="col-md-3 text-center" *ngIf="end">
            <mat-card class="card p-5 analyze-item items-center justify-col analyze-item-content">
                <button class="analyze-btn">
                    <mat-icon>assignment_turned_in</mat-icon>
                </button>
                <h3 class="mt-3 text-32">
                    {{end}}
                </h3>
                <p class="analyze-text m-0">已結案專案</p>
            </mat-card>
        </div>
    </div>
    <!-- <div class="row pb-4">
        <div class="col-md-6 text-center">
            <mat-card class=" card panel panel-default pb-5 panel-hovered analytics">
                <h5 class="panel-heading">專案-狀態件數統計</h5>
                <hr width="500px" class="my-3" style="margin: auto;">
                <img mat-card-image src=".././assets/img/statistic/statistic_1.PNG" alt="">
            </mat-card>
        </div>
        <div class="col-md-6 text-center">
            <mat-card class="card pb-5">
                <h5 class="panel-heading">專案負責人-專案件數統計</h5>
                <hr width="500px" class="my-3" style="margin: auto;">
                <img mat-card-image src=".././assets/img/statistic/statistic_2.PNG" alt="">
            </mat-card>
        </div>
    </div> -->
    <div class="row pb-4">
        <div class="col-md-12 text-center">
            <mat-card class="card">
                <h5 class="panel-heading">專案狀態-專案件數統計</h5>
                <hr width="95%" class="my-3" style="margin: auto;">
                <div style="display: block">
                    <canvas baseChart [datasets]="barChartData" [labels]="barChartLabels" [options]="barChartOptions"
                        [legend]="barChartLegend" [chartType]="barChartType">
                    </canvas>
                </div>
            </mat-card>
        </div>
    </div>
    <!-- <div class="row pb-4" >
        <div class="col" *ngIf="B1B2Datas" >
            <p>{{ B1B2Datas.p_code }}</p>
        </div>
    </div> -->
</div>


<!--chart-->
<script src="node_modules/chart.js/src/chart.js"></script>